version: '3.4'

services:
  mywebapi:
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
    ports:
      - "80"
    labels:
      - traefik.enable=true
      - traefik.http.routers.myapp.tls=true
      - traefik.http.routers.myapp.rule=Host("myapi.docker.localhost")
  
  traefik:
    image: "traefik:v2.4"
    container_name: "traefik"
    labels:
        - "traefik.enable=true"
        - "traefik.http.routers.traefik=true"
    ports:
        # HTTPS / SSL port
        - "443:443"
        # The Traefik Web UI port (enabled by api:insecure: true in traefik.yml)
        - "8080:8080"
    volumes:
        - ./traefik/traefik.yml:/etc/traefik/traefik.yml:ro
        - ./traefik/config.yml:/etc/traefik/config.yml:ro
        - ./certs:/etc/certs:ro
        - /var/run/docker.sock:/var/run/docker.sock:ro
